<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Edit Taskboard</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Eras+ITC">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">
    <style>
        .custom-font {
            font-family: 'Eras ITC', sans-serif;
        }
        /* Additional custom styling may be required if Tailwind does not support certain specifics */
    </style>
</head>
<body class="bg-gray-800 text-white custom-font">
    <div class="flex justify-between p-4">
        <div>
            <button onclick="fetchTaskboardData()" id="taskboard-name-button" class="bg-gray-700 hover:bg-gray-600 text-white font-bold py-2 px-4">My New Taskboard</button>
            <button class="bg-gray-700 hover:bg-gray-600 text-white font-bold py-2 px-4 ml-2 rounded">Save</button>
            <button onclick="duplicateTaskboard()" class="bg-gray-700 hover:bg-gray-600 text-white font-bold py-2 px-4 ml-2 rounded">Duplicate</button>
            <button onclick="confirmDeletion()" class="bg-gray-700 hover:bg-gray-600 text-white font-bold py-2 px-4 ml-2 rounded">Delete</button>
            <button class="bg-gray-700 hover:bg-gray-600 text-white font-bold py-2 px-4 ml-2 rounded">New</button>
            <button id="close-button" class="bg-gray-700 hover:bg-gray-600 text-white font-bold py-2 px-4 ml-2 rounded">Close</button>
        </div>
        <div>
            <button id="settings-button" class="bg-gray-700 hover:bg-gray-600 text-white font-bold py-2 px-4 rounded">Settings</button>
        </div>
    </div>

    <div class="flex">
        <div class="w-3/4 p-4">
            <div class="mb-4">
                <h2 class="text-blue-300 mb-2">Tile Settings</h2>
                <div class="flex flex-wrap -mx-2">
                    <div class="px-2 w-1/2">
                        <label class="block text-gray-500 text-sm mb-1" for="columns">Columns</label>
                        <input type="number" id="columns" value="10" class="w-full bg-gray-700 rounded text-white p-2">
                    </div>
                    <div class="px-2 w-1/2">
                        <label class="block text-gray-500 text-sm mb-1" for="rows">Rows</label>
                        <input type="number" id="rows" value="10" class="w-full bg-gray-700 rounded text-white p-2">
                    </div>
                    <!-- Repeat this structure for all the other input fields as shown in the screenshot -->
                    <!-- Make sure to match the text, value, and any other attributes exactly as they appear in the screenshot -->
                </div>
            </div>
            <div>
                <h2 class="text-blue-300 mb-2">Formatting</h2>
                <div class="flex flex-wrap -mx-2">
                    <div class="px-2 w-1/2">
                        <label class="block text-gray-500 text-sm mb-1" for="font-size">Font Size</label>
                        <input type="number" id="font-size" value="0" class="w-full bg-blue-600 rounded text-white p-2">
                    </div>
                    <div class="px-2 w-1/2">
                        <label class="block text-gray-500 text-sm mb-1" for="font-color">Font Color</label>
                        <input type="text" id="font-color" value="Black" class="w-full bg-blue-600 rounded text-white p-2">
                    </div>
                </div>
                <div class="flex flex-wrap -mx-2 mt-4">
                    <div class="px-2 w-1/2">
                        <label class="block text-gray-500 text-sm mb-1" for="bg-color">Background Color</label>
                        <input type="text" id="bg-color" value="Grey" class="w-full bg-blue-600 rounded text-white p-2">
                    </div>
                    <div class="px-2 w-1/2">
                        <label class="block text-gray-500 text-sm mb-1" for="bg-color">Font Family</label>
                        <input type="text" id="bg-color" value="Eras ITC" class="w-full bg-blue-600 rounded text-white p-2">
                    </div>
                </div>
            </div>
            <div>
                <h2 class="text-blue-300 mb-2">Linking</h2>
                <div class="flex flex-wrap -mx-2">
                    <div class="px-2 w-1/2">
                        <label class="block text-gray-500 text-sm mb-1" for="font-size">Master Taskboard</label>
                        <input type="text" id="font-size" value="Disabled" class="w-full bg-blue-600 rounded text-white p-2">
                    </div>
                    <div class="px-2 w-1/2">
                        <label class="block text-gray-500 text-sm mb-1" for="font-color">Online Source</label>
                        <input type="text" id="font-color" value="Disabled" class="w-full bg-blue-600 rounded text-white p-2">
                    </div>
                </div>
                <div class="flex flex-wrap -mx-2 mt-4">
                    <div class="px-2 w-1/2">
                        <label class="block text-gray-500 text-sm mb-1" for="bg-color">Auto-Update</label>
                        <input type="text" id="bg-color" value="Yes" class="w-full bg-blue-600 rounded text-white p-2">
                    </div>
                    <div class="px-2 w-1/2">
                        <label class="block text-gray-500 text-sm mb-1" for="bg-color">Update File</label>
                        <input type="text" id="bg-color" value="None" class="w-full bg-blue-600 rounded text-white p-2">
                    </div>
                </div>
            </div>

            <div>
                <h2 class="text-blue-300 mb-2">Data Builder</h2>
                <div class="flex flex-wrap -mx-2">
                    <div class="px-2 w-1/2">
                        <label class="block text-gray-500 text-sm mb-1" for="font-size">Title Header</label>
                        <input type="number" id="font-size" value="Disabled" class="w-full bg-blue-600 rounded text-white p-2">
                    </div>
                    <div class="px-2 w-1/2">
                        <label class="block text-gray-500 text-sm mb-1" for="font-color">Text-Wrapping</label>
                        <input type="text" id="font-color" value="Disabled" class="w-full bg-blue-600 rounded text-white p-2">
                    </div>
                </div>
                <div class="flex flex-wrap -mx-2 mt-4">
                    <div class="px-2 w-1/2">
                        <label class="block text-gray-500 text-sm mb-1" for="bg-color">Sorting Header</label>
                        <input type="text" id="bg-color" value="Yes" class="w-full bg-blue-600 rounded text-white p-2">
                    </div>
                    <div class="px-2 w-1/2">
                        <label class="block text-gray-500 text-sm mb-1" for="bg-color">Sort By</label>
                        <input type="text" id="bg-color" value="None" class="w-full bg-blue-600 rounded text-white p-2">
                    </div>
                </div>
            </div>
                    <!-- More settings follow the same pattern -->
        </div>
        <div class="w-1/4 p-4">
            <h2 class="text-blue-300 mb-2">Filter Editor</h2>
            <input type="text" id="filter-editor" class="w-full bg-gray-700 rounded text-white p-2">
        </div>
    </div>

    <script>

        document.getElementById('taskboard-name-button').addEventListener('click', function() {
            const urlParams = new URLSearchParams(window.location.search);
            const taskboardName = urlParams.get('name');
            if (taskboardName) {
                window.location.href = `/?name=${encodeURIComponent(taskboardName)}`;
            } else {
                alert('No taskboard specified.');
            }
        });


        document.getElementById('close-button').addEventListener('click', function() {
            window.location.href = '/';
        });

        document.getElementById('settings-button').addEventListener('click', function() {
            // To open in the same tab:
            window.location.href = 'settings';

        });

        document.addEventListener('DOMContentLoaded', function() {
            const urlParams = new URLSearchParams(window.location.search);
            const taskboardName = urlParams.get('name');
            console.log('URL Parameters:', urlParams.toString());
            console.log('Taskboard Name:', taskboardName);

            if (!taskboardName) {
                alert('No taskboard specified for editing.');
            }
        });

        async function confirmDeletion() {
            if (confirm("Are you sure you want to delete this taskboard?")) {
                const urlParams = new URLSearchParams(window.location.search);
                const taskboardName = urlParams.get('name');
                console.log('Taskboard Name:', taskboardName);

                try {
                    const response = await fetch(`/delete/?name=${taskboardName}`, { method: 'DELETE' });
                    if (response.ok) {
                        console.log('Taskboard deleted successfully.');
                        // Redirect to home or refresh
                        // window.location.href = 'home.html';
                        // location.reload();
                    } else {
                        console.error('Failed to delete taskboard.');
                    }
                } catch (error) {
                    console.error('Error:', error);
                }
            }
        }

        async function duplicateTaskboard() {
            const newTaskboardName = prompt('Please enter a name for the new taskboard:');
            if (!newTaskboardName) {
                alert('Taskboard duplication cancelled.');
                return;
            }

            const urlParams = new URLSearchParams(window.location.search);
            const currentTaskboardName = urlParams.get('name');

            try {
                const response = await fetch(`/duplicate?currentName=${encodeURIComponent(currentTaskboardName)}&newName=${encodeURIComponent(newTaskboardName)}`, { method: 'POST' });
                if (response.ok) {
                    alert('Taskboard duplicated successfully.');
                    // Optionally, redirect to the edit page of the new taskboard
                    // window.location.href = `/edit?name=${encodeURIComponent(newTaskboardName)}`;
                } else {
                    alert('Failed to duplicate taskboard.');
                }
            } catch (error) {
                console.error('Error:', error);
            }
        }

        async function fetchTaskboardData() {
            // Get the taskboard name from URL parameters
            const urlParams = new URLSearchParams(window.location.search);
            const currentTaskboardName = urlParams.get('name');
        
            // Check if a taskboard name is present
            if (currentTaskboardName) {
                // Redirect to the taskboard view page
                window.location.href = `/get/?name=${encodeURIComponent(currentTaskboardName)}`;
            } else {
                // Handle the case where no taskboard name is present
                alert('No taskboard specified.');
            }
        }
        
    </script>
</body>
</html>
